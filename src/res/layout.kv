#:set VeryDarkGreen (10/5/255.0,45/5/255.0,35/5/255.0,1)
#:set DarkGreen (10/255.0,45/255.0,35/255.0,1)
#:set LightGreen (25/255.0,117/255.0,93/255.0,1)
#:set DarkGray (0.18,0.18,0.18,1)
#:set LightGray (0.86,0.86,0.86,1)
#:set White (1,1,1,1)
#:set Black (0,0,0,1)

############## ACTIVITIES ###################
<Activity_Login@BoxLayout>
	#Properties
	student_name: 'Fulano de Tal'
	student_username: '123456789'
	student_photo: 'res/android/ic_contact_picture.png'

	#Hack: Dropdown weakref
	#Mais info. na definicao do widget KivyDropDown
	dropdown_safe_id: dropdown.__self__
	on_parent: dropdown.dismiss()

	KivyActivity:		
		orientation: 'vertical'
		
		KivyActionBar:
			icon: 'res/logo-white.png'
			title: ' SigmaWeb+'
			
			AnchorLayout:
				id: action_button
				anchor_x: 'right'
				
				KivyActionBarButton:
					icon: 'res/android/ic_menu_moreoverflow_normal_holo_dark.png'					
					on_release: 
						dropdown.open(action_button)
					
				KivyDropDown:
					id: dropdown
					
					KivyDropDownItem:
						text: 'Sobre'
						on_release: dropdown.select(self.text)
						height: action_button.height
					
					KivyDropDownItem:
						text: 'Desconectar'
						on_release: dropdown.select(self.text)
						height: action_button.height 
				
		BoxLayout:
			orientation: 'vertical'
			
			#Header com a foto e o nome do aluno
			BoxLayout:
				padding: (20,10)
				size_hint: (1, 0.25)
				
				Image:
					size_hint: (None, 1)
					width: self.height
					allow_stretch: True
					source: root.student_photo
				
				BoxLayout:
					padding: (10, 0)
					orientation: 'vertical'
					
					Label:
						size_hint: (1, 0.6)
						color: DarkGray
						markup: True
						halign: 'center'
						valign: 'middle'
						text: '[b]' + root.student_name + '[/b]'
						font_size: self.height / 3
						text_size: self.size
						
					
					Label:
						size_hint: (1, 0.4)
						color: DarkGray
						markup: True
						halign: 'center'
						valign: 'middle'
						text: root.student_username
						font_size: self.height / 2
						text_size: self.size
			
			BoxLayout:
				


############## DEFINITIONS ###################

<KivyDropDown@DropDown>
	#Hack: Dropdown weakref
	#Eu comentei essa linha e movi o dropdown.dismiss() para o widget principal por causa de problemas com weakref
	#Se eu dou um dismiss no widget assim que ele Ã© adicionado ao layout. O garbage collector deleta ele
	#on_parent: self.dismiss()
	
<KivyDropDownItem@Button>
	#background_color: Black
	size_hint_y: None
	font_size: self.height / 2

<KivyActivity@BoxLayout>
	canvas.before:
		Color:
			rgb: LightGray
		Rectangle:
			pos: self.pos
			size: self.size

<KivyActionBarButton@Button>
	#Property
	icon: ''
	background_color: DarkGreen
	
	#Style
	size_hint: None,1
	width: self.height
	
	#Function
	overlay: 0
	
	on_press:
		root.overlay = 0.6
		#if self.btn_active == 1: app.on_event(self.eventname)
	
	on_release: 
		root.overlay = 0
	
	canvas.after:
		Color:
			rgb: root.background_color
		Rectangle:
			pos: self.pos
			size: self.size
		Color:
			rgb: White
		Rectangle:
			source: root.icon
			pos: (self.center_x-self.height*0.7/2, self.center_y-self.height*0.7/2)
			size: (self.height*0.7, self.height*0.7)
		Color:
			rgba: 0,0,0,root.overlay
		Rectangle:
			pos: self.pos
			size: self.size
	
	

<KivyActionBar@BoxLayout>
	#Property
	icon: ''
	title: ''

	#Style
	size_hint: 1, 0.10
	
	canvas.before:
		Color:
			rgb: DarkGreen
		Rectangle:
			pos: self.pos
			size: self.size
	
	canvas.after:
		Color:
			rgb: VeryDarkGreen
		Line:
			points: (0, self.center_y-self.height/2, self.width,self.center_y-self.height/2)
	
	AnchorLayout:
		anchor_x: 'left'
		
		BoxLayout:
			Image:
				source: root.icon
				size_hint: None,0.7
				width: self.height + 20
				pos_hint: {'x': 0, 'y': 0.15}
		
			Label:
				size_hint: (None, 1)
				halign: 'left'
				width: self.texture_size[0]
				markup: True
				font_size: self.height/2*0.7
				text: root.title
